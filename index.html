<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Realistic Dark Office Suite</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body{background:#1e1e2f;color:#f0f0f0;font-family:'Inter',sans-serif;margin:0;padding:0;}
.container{padding:1rem;max-width:1400px;margin:auto;}
button,select,input{background:#2b2b3b;color:#f0f0f0;padding:0.3rem 0.6rem;border-radius:0.25rem;border:1px solid #444;margin:0.2rem;cursor:pointer;}
button:hover,select:hover,input:hover{background:#3b3b5c;}
.tabs button{background:#3b3b5c;margin-right:0.25rem;}
.tabs button.active{background:#3b82f6;}
.editor-container,.excel-container,.pdf-editor{background:#2b2b3b;border-radius:0.5rem;padding:0.5rem;margin-top:0.5rem;min-height:300px;overflow:auto;border:1px solid #444;color:#f0f0f0;}
.ql-toolbar.ql-snow{background:#3b3b5c;border:1px solid #444;color:#f0f0f0;flex-wrap:wrap;}
.ql-container.ql-snow{background:#2b2b3b;color:#f0f0f0;border:1px solid #444;min-height:250px;}
.ql-picker-label,.ql-picker-item,.ql-stroke,.ql-fill{color:#f0f0f0!important;}
.excel-container table{border-collapse:collapse;width:100%;}
.excel-container td,.excel-container th{border:1px solid #555;padding:0.3rem;color:#f0f0f0;background:#2b2b3b;}
.excel-container td:focus{outline:2px solid #3b82f6;background:#3b3b5c;}
.pdf-editor{white-space:pre-wrap;outline:none;padding:0.5rem;}
.drag-drop{border:2px dashed #3b82f6;padding:2rem;border-radius:0.5rem;text-align:center;cursor:pointer;margin-bottom:1rem;transition:0.2s;}
.drag-drop:hover{background:#3b3b5c;}
.toolbar-group{margin:0.2rem;display:inline-block;}
.excel-headers{display:flex;font-weight:bold;background:#3b3b5c;}
.excel-headers div{flex:1;padding:0.2rem;text-align:center;border:1px solid #555;}
.formula-bar{background:#2b2b3b;color:#f0f0f0;padding:0.3rem;border:1px solid #444;margin-bottom:0.2rem;width:100%;border-radius:0.25rem;}
</style>
</head>
<body>
<div class="container">
<h1 class="text-2xl mb-2 text-center">ðŸ–¥ Realistic Dark Office Suite</h1>

<div class="flex flex-wrap gap-2 justify-center mb-2">
  <button id="newText">New Word</button>
  <button id="newExcel">New Excel</button>
  <button id="newPDF">New PDF</button>
  <button id="uploadBtn">Upload</button>
  <button id="downloadBtn">Download</button>
  <button id="printBtn">Print</button>
  <button id="clearBtn">Clear</button>
</div>

<div id="dragDrop" class="drag-drop mb-2">Drag & Drop Files Here or Tap to Browse</div>
<input type="file" id="fileInput" multiple style="display:none;"/>

<div class="tabs mb-2 flex flex-wrap justify-center">
  <button class="active" data-tab="textTab">Word</button>
  <button data-tab="excelTab">Excel</button>
  <button data-tab="pdfTab">PDF</button>
</div>

<!-- Word Toolbar -->
<div id="wordToolbar" class="editor-container" style="display:block;">
  <div class="toolbar-group">
    <select class="ql-font"></select>
    <select class="ql-size"></select>
    <button class="ql-bold"></button>
    <button class="ql-italic"></button>
    <button class="ql-underline"></button>
    <button class="ql-strike"></button>
    <button class="ql-clean"></button>
  </div>
  <div class="toolbar-group">
    <button class="ql-list" value="ordered"></button>
    <button class="ql-list" value="bullet"></button>
    <button class="ql-link"></button>
    <button class="ql-image"></button>
    <button class="ql-video"></button>
  </div>
  <div class="toolbar-group">
    <select class="ql-color"></select>
    <select class="ql-background"></select>
    <select class="ql-align"></select>
  </div>
</div>

<div id="textTab" class="editor-container" style="display:block;"></div>

<!-- Excel Editor -->
<input type="text" id="excelFormula" class="formula-bar" placeholder="Formula Bar" style="display:none;">
<div id="excelTab" class="excel-container" style="display:none;"></div>

<!-- PDF Editor -->
<div id="pdfTab" class="pdf-editor" contenteditable="true" style="display:none;"></div>
</div>

<script>
// Tab switching
const tabs=document.querySelectorAll('.tabs button');
const editors={ textTab: document.getElementById('textTab'), excelTab: document.getElementById('excelTab'), pdfTab: document.getElementById('pdfTab') };
const wordToolbar=document.getElementById('wordToolbar');
const formulaBar=document.getElementById('excelFormula');
tabs.forEach(tab=>tab.addEventListener('click',()=>{
  tabs.forEach(t=>t.classList.remove('active'));
  tab.classList.add('active');
  for(let k in editors) editors[k].style.display='none';
  wordToolbar.style.display='none';
  formulaBar.style.display='none';
  if(tab.dataset.tab==='textTab'){editors.textTab.style.display='block'; wordToolbar.style.display='block';}
  else if(tab.dataset.tab==='excelTab'){editors.excelTab.style.display='block'; formulaBar.style.display='block';}
  else if(tab.dataset.tab==='pdfTab') editors.pdfTab.style.display='block';
}));

// Quill Word Editor
const quill=new Quill('#textTab',{theme:'snow',modules:{toolbar:'#wordToolbar'}});

// File Handling
const fileInput=document.getElementById('fileInput');
const dragDrop=document.getElementById('dragDrop');
dragDrop.addEventListener('click',()=>fileInput.click());
dragDrop.addEventListener('dragover',e=>{e.preventDefault();dragDrop.style.background="#3b3b5c";});
dragDrop.addEventListener('dragleave',()=>{dragDrop.style.background="#2b2b3b";});
dragDrop.addEventListener('drop',e=>{e.preventDefault();dragDrop.style.background="#2b2b3b";handleFiles(e.dataTransfer.files);});
fileInput.addEventListener('change',e=>handleFiles(e.target.files));

async function handleFiles(files){
  for(let file of files){
    const ext=file.name.split('.').pop().toLowerCase();
    if(ext==='xlsx'||ext==='xls'||ext==='csv'){
      const data=await file.arrayBuffer();
      const workbook=XLSX.read(data);
      const firstSheet=workbook.Sheets[workbook.SheetNames[0]];
      editors.excelTab.innerHTML=XLSX.utils.sheet_to_html(firstSheet,{editable:true});
      makeExcelEditable(); tabs[1].click();
    } else {
      const text=await file.text();
      quill.setText(text);
      tabs[0].click();
    }
  }
}

// New Documents
document.getElementById('newText').addEventListener('click',()=>{ quill.setText(''); tabs[0].click(); });
document.getElementById('newExcel').addEventListener('click',()=>{ tabs[1].click(); createExcelGrid(20,20); });
document.getElementById('newPDF').addEventListener('click',()=>{ editors.pdfTab.innerHTML=''; tabs[2].click(); });

// Excel Grid
function createExcelGrid(rows,cols){
  let html='<div class="excel-headers"><div></div>';
  for(let c=0;c<cols;c++) html+='<div>'+String.fromCharCode(65+c)+'</div>';
  html+='</div><table>';
  for(let r=0;r<rows;r++){
    html+='<tr><th>'+(r+1)+'</th>';
    for(let c=0;c<cols;c++) html+='<td contenteditable="true"></td>';
    html+='</tr>';
  }
  html+='</table>';
  editors.excelTab.innerHTML=html;
}

// Excel Editable & Formula Bar
function makeExcelEditable(){
  const cells=editors.excelTab.querySelectorAll('td');
  cells.forEach(cell=>{
    cell.addEventListener('focus',()=>formulaBar.value=cell.innerText);
    cell.addEventListener('input',()=>formulaBar.value=cell.innerText);
  });
}
formulaBar.addEventListener('change',()=>{
  const active=document.activeElement;
  if(active.tagName==='TD'){active.innerText=formulaBar.value;}
});

// Excel Formulas
function calculateExcel(){
  const table=editors.excelTab.querySelector('table');
  if(!table) return;
  const rows=table.rows;
  for(let r=0;r<rows.length;r++){
    for(let c=0;c<rows[r].cells.length;c++){
      let val=rows[r].cells[c].innerText.trim();
      if(val.startsWith('=')){
        try{
          val=val.substring(1).replace(/([A-Z]+)(\d+)/g,(m,col,row)=>{
            const colIndex=col.charCodeAt(0)-65;
            const rowIndex=parseInt(row)-1;
            return rows[rowIndex]?.cells[colIndex]?.innerText||0;
          });
          rows[r].cells[c].innerText=eval(val);
        }catch(e){rows[r].cells[c].innerText='ERROR';}
      }
    }
  }
}
setInterval(calculateExcel,1000);

// Download & Print
function downloadBlob(blob,filename){const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=filename;a.click();URL.revokeObjectURL(url);}
document.getElementById('downloadBtn').addEventListener('click',()=>{
  const activeTab=document.querySelector('.tabs button.active').dataset.tab;
  if(activeTab==='textTab') downloadBlob(new Blob([quill.root.innerHTML],{type:'text/html'}),'document.html');
  else if(activeTab==='excelTab'){
    const table=editors.excelTab.querySelector('table');
    const ws=XLSX.utils.table_to_sheet(table);
    const wb=XLSX.utils.book_new(); XLSX.utils.book_append_sheet(wb,ws,'Sheet1');
    XLSX.writeFile(wb,'spreadsheet.xlsx');
  } else if(activeTab==='pdfTab'){
    const { jsPDF }=window.jspdf;
    const doc=new jsPDF();
    const text=editors.pdfTab.innerText;
    const lines=doc.splitTextToSize(text,180);
    doc.text(lines,10,10);
    doc.save('document.pdf');
  }
});
document.getElementById('printBtn').addEventListener('click',()=>{
  const activeTab=document.querySelector('.tabs button.active').dataset.tab;
  const printWindow=window.open('','','width=800,height=600');
  if(activeTab==='textTab') printWindow.document.write('<html><body style="background:#1e1e2f;color:#f0f0f0;">'+quill.root.innerHTML+'</body></html>');
  else if(activeTab==='excelTab') printWindow.document.write('<html><body style="background:#1e1e2f;color:#f0f0f0;">'+editors.excelTab.innerHTML+'</body></html>');
  else if(activeTab==='pdfTab') printWindow.document.write('<html><body style="background:#1e1e2f;color:#f0f0f0;">'+editors.pdfTab.innerHTML+'</body></html>');
  printWindow.document.close(); printWindow.print();
});

// Clear
document.getElementById('clearBtn').addEventListener('click',()=>{ quill.setText(''); editors.excelTab.innerHTML=''; editors.pdfTab.innerHTML=''; });
</script>
</body>
</html>
